"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/claims/save/route";
exports.ids = ["app/api/claims/save/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "sqlite3":
/*!**************************!*\
  !*** external "sqlite3" ***!
  \**************************/
/***/ ((module) => {

module.exports = require("sqlite3");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fclaims%2Fsave%2Froute&page=%2Fapi%2Fclaims%2Fsave%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fclaims%2Fsave%2Froute.ts&appDir=%2FUsers%2Fvinaykumar%2FDesktop%2Fdss-atlas-digitalisation%2Fdss-atlas%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fvinaykumar%2FDesktop%2Fdss-atlas-digitalisation%2Fdss-atlas&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fclaims%2Fsave%2Froute&page=%2Fapi%2Fclaims%2Fsave%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fclaims%2Fsave%2Froute.ts&appDir=%2FUsers%2Fvinaykumar%2FDesktop%2Fdss-atlas-digitalisation%2Fdss-atlas%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fvinaykumar%2FDesktop%2Fdss-atlas-digitalisation%2Fdss-atlas&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_vinaykumar_Desktop_dss_atlas_digitalisation_dss_atlas_app_api_claims_save_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/claims/save/route.ts */ \"(rsc)/./app/api/claims/save/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/claims/save/route\",\n        pathname: \"/api/claims/save\",\n        filename: \"route\",\n        bundlePath: \"app/api/claims/save/route\"\n    },\n    resolvedPagePath: \"/Users/vinaykumar/Desktop/dss-atlas-digitalisation/dss-atlas/app/api/claims/save/route.ts\",\n    nextConfigOutput,\n    userland: _Users_vinaykumar_Desktop_dss_atlas_digitalisation_dss_atlas_app_api_claims_save_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/claims/save/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZjbGFpbXMlMkZzYXZlJTJGcm91dGUmcGFnZT0lMkZhcGklMkZjbGFpbXMlMkZzYXZlJTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGY2xhaW1zJTJGc2F2ZSUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRnZpbmF5a3VtYXIlMkZEZXNrdG9wJTJGZHNzLWF0bGFzLWRpZ2l0YWxpc2F0aW9uJTJGZHNzLWF0bGFzJTJGYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj0lMkZVc2VycyUyRnZpbmF5a3VtYXIlMkZEZXNrdG9wJTJGZHNzLWF0bGFzLWRpZ2l0YWxpc2F0aW9uJTJGZHNzLWF0bGFzJmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDYztBQUN5QztBQUN0SDtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlFQUFpRTtBQUN6RTtBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ3VIOztBQUV2SCIsInNvdXJjZXMiOlsid2VicGFjazovL2ZyYS1hdGxhcy8/MmQ1NSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIvVXNlcnMvdmluYXlrdW1hci9EZXNrdG9wL2Rzcy1hdGxhcy1kaWdpdGFsaXNhdGlvbi9kc3MtYXRsYXMvYXBwL2FwaS9jbGFpbXMvc2F2ZS9yb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvY2xhaW1zL3NhdmUvcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9jbGFpbXMvc2F2ZVwiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvY2xhaW1zL3NhdmUvcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCIvVXNlcnMvdmluYXlrdW1hci9EZXNrdG9wL2Rzcy1hdGxhcy1kaWdpdGFsaXNhdGlvbi9kc3MtYXRsYXMvYXBwL2FwaS9jbGFpbXMvc2F2ZS9yb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzIH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvY2xhaW1zL3NhdmUvcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fclaims%2Fsave%2Froute&page=%2Fapi%2Fclaims%2Fsave%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fclaims%2Fsave%2Froute.ts&appDir=%2FUsers%2Fvinaykumar%2FDesktop%2Fdss-atlas-digitalisation%2Fdss-atlas%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fvinaykumar%2FDesktop%2Fdss-atlas-digitalisation%2Fdss-atlas&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/claims/save/route.ts":
/*!**************************************!*\
  !*** ./app/api/claims/save/route.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_dbSqlite__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/dbSqlite */ \"(rsc)/./lib/dbSqlite.ts\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! crypto */ \"crypto\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(crypto__WEBPACK_IMPORTED_MODULE_2__);\n// Imported from Multilingual Copy - Data Digitalization Module - Safe Integration\n\n\n\n/**\n * POST /api/claims/save\n * Save or update a claim with versioning\n */ async function POST(request) {\n    try {\n        const body = await request.json();\n        const { feature, saved_by } = body;\n        // Validate request\n        if (!feature || !feature.properties || !feature.geometry) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Invalid feature object\"\n            }, {\n                status: 400\n            });\n        }\n        if (!saved_by) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"saved_by is required\"\n            }, {\n                status: 400\n            });\n        }\n        const { claim_id, claim_type, confidence, flags = [] } = feature.properties;\n        if (!claim_id || !claim_type || confidence === undefined) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Missing required properties: claim_id, claim_type, confidence\"\n            }, {\n                status: 400\n            });\n        }\n        // Prepare data for storage\n        // Strict Geometry Validation\n        if (!feature.geometry || !feature.geometry.type || !feature.geometry.coordinates) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"missing_geometry\",\n                message: \"Feature geometry missing or invalid\"\n            }, {\n                status: 400\n            });\n        }\n        // Validate coordinates range (basic check)\n        // TODO: Use Turf.js for more complex validation if needed\n        const isPoint = feature.geometry.type === \"Point\";\n        const isPolygon = feature.geometry.type === \"Polygon\" || feature.geometry.type === \"MultiPolygon\";\n        if (!isPoint && !isPolygon) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"invalid_geometry_type\",\n                message: \"Only Point, Polygon, and MultiPolygon are supported\"\n            }, {\n                status: 400\n            });\n        }\n        const geojsonStr = JSON.stringify(feature);\n        const flagsStr = JSON.stringify(flags);\n        // Use SQLite database operations\n        const db = await (0,_lib_dbSqlite__WEBPACK_IMPORTED_MODULE_1__.getDb)();\n        // Check if claim already exists\n        const existingClaim = await db.get(\"SELECT id, version FROM claims WHERE claim_id = ?\", [\n            claim_id\n        ]);\n        let claimDbId = existingClaim ? existingClaim.id : (0,crypto__WEBPACK_IMPORTED_MODULE_2__.randomUUID)();\n        let newVersion = existingClaim ? existingClaim.version + 1 : 1;\n        let savedAt;\n        if (existingClaim) {\n            // Update existing claim\n            await db.run(`UPDATE claims \n                SET geojson = ?, current_flags = ?, current_confidence = ?, saved_by = ?, version = ?, saved_at = datetime('now'), claim_type = ?\n                WHERE id = ?`, [\n                geojsonStr,\n                flagsStr,\n                confidence,\n                saved_by,\n                newVersion,\n                claim_type,\n                claimDbId\n            ]);\n            // Fetch updated timestamp\n            const updated = await db.get(\"SELECT saved_at FROM claims WHERE id = ?\", [\n                claimDbId\n            ]);\n            savedAt = updated.saved_at;\n        } else {\n            // Insert new claim\n            await db.run(`INSERT INTO claims \n                (id, claim_id, claim_type, geojson, current_flags, current_confidence, saved_by, version, saved_at)\n                VALUES (?, ?, ?, ?, ?, ?, ?, ?, datetime('now'))`, [\n                claimDbId,\n                claim_id,\n                claim_type,\n                geojsonStr,\n                flagsStr,\n                confidence,\n                saved_by,\n                newVersion\n            ]);\n            // Fetch timestamp\n            const inserted = await db.get(\"SELECT saved_at FROM claims WHERE id = ?\", [\n                claimDbId\n            ]);\n            savedAt = inserted.saved_at;\n        }\n        // Archive version\n        const versionId = (0,crypto__WEBPACK_IMPORTED_MODULE_2__.randomUUID)();\n        await db.run(`INSERT INTO claim_versions \n            (id, claim_db_id, version, geojson, flags, confidence, saved_by, saved_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, datetime('now'))`, [\n            versionId,\n            claimDbId,\n            newVersion,\n            geojsonStr,\n            flagsStr,\n            confidence,\n            saved_by\n        ]);\n        const result = {\n            id: claimDbId,\n            claim_id,\n            version: newVersion,\n            saved_at: savedAt,\n            has_geometry: true\n        };\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            ...result\n        });\n    } catch (error) {\n        console.error(\"Error saving claim:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Failed to save claim\",\n            details: String(error),\n            stack: error.stack\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q0FBQyxFQUNqRDtnQkFBQ0w7Z0JBQVdqQjtnQkFBVUM7Z0JBQVlTO2dCQUFZRztnQkFBVVg7Z0JBQVlQO2dCQUFVd0I7YUFBVztZQUc3RixrQkFBa0I7WUFDbEIsTUFBTU0sV0FBVyxNQUFNWCxHQUFHRSxHQUFHLENBQUMsNENBQTRDO2dCQUFDQzthQUFVO1lBQ3JGSSxVQUFVSSxTQUFTRCxRQUFRO1FBQy9CO1FBRUEsa0JBQWtCO1FBQ2xCLE1BQU1FLFlBQVlyQyxrREFBVUE7UUFDNUIsTUFBTXlCLEdBQUdRLEdBQUcsQ0FDUixDQUFDOzt5REFFNEMsQ0FBQyxFQUM5QztZQUFDSTtZQUFXVDtZQUFXRTtZQUFZVDtZQUFZRztZQUFVWDtZQUFZUDtTQUFTO1FBR2xGLE1BQU1nQyxTQUFTO1lBQ1hULElBQUlEO1lBQ0pqQjtZQUNBb0IsU0FBU0Q7WUFDVEssVUFBVUg7WUFDVk8sY0FBYztRQUNsQjtRQUVBLE9BQU96QyxxREFBWUEsQ0FBQ00sSUFBSSxDQUFDO1lBQ3JCb0MsU0FBUztZQUNULEdBQUdGLE1BQU07UUFDYjtJQUVKLEVBQUUsT0FBTzdCLE9BQVk7UUFDakJnQyxRQUFRaEMsS0FBSyxDQUFDLHVCQUF1QkE7UUFDckMsT0FBT1gscURBQVlBLENBQUNNLElBQUksQ0FDcEI7WUFDSUssT0FBTztZQUNQaUMsU0FBU0MsT0FBT2xDO1lBQ2hCbUMsT0FBT25DLE1BQU1tQyxLQUFLO1FBQ3RCLEdBQ0E7WUFBRWxDLFFBQVE7UUFBSTtJQUV0QjtBQUNKIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZnJhLWF0bGFzLy4vYXBwL2FwaS9jbGFpbXMvc2F2ZS9yb3V0ZS50cz80YjVmIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIEltcG9ydGVkIGZyb20gTXVsdGlsaW5ndWFsIENvcHkgLSBEYXRhIERpZ2l0YWxpemF0aW9uIE1vZHVsZSAtIFNhZmUgSW50ZWdyYXRpb25cbmltcG9ydCB7IE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcic7XG5pbXBvcnQgeyBnZXREYiB9IGZyb20gJ0AvbGliL2RiU3FsaXRlJztcbmltcG9ydCB7IHJhbmRvbVVVSUQgfSBmcm9tICdjcnlwdG8nO1xuXG4vKipcbiAqIFBPU1QgL2FwaS9jbGFpbXMvc2F2ZVxuICogU2F2ZSBvciB1cGRhdGUgYSBjbGFpbSB3aXRoIHZlcnNpb25pbmdcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBPU1QocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcbiAgICB0cnkge1xuICAgICAgICBjb25zdCBib2R5ID0gYXdhaXQgcmVxdWVzdC5qc29uKCk7XG4gICAgICAgIGNvbnN0IHsgZmVhdHVyZSwgc2F2ZWRfYnkgfSA9IGJvZHk7XG5cbiAgICAgICAgLy8gVmFsaWRhdGUgcmVxdWVzdFxuICAgICAgICBpZiAoIWZlYXR1cmUgfHwgIWZlYXR1cmUucHJvcGVydGllcyB8fCAhZmVhdHVyZS5nZW9tZXRyeSkge1xuICAgICAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICAgICAgICAgIHsgZXJyb3I6ICdJbnZhbGlkIGZlYXR1cmUgb2JqZWN0JyB9LFxuICAgICAgICAgICAgICAgIHsgc3RhdHVzOiA0MDAgfVxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghc2F2ZWRfYnkpIHtcbiAgICAgICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgICAgICAgICB7IGVycm9yOiAnc2F2ZWRfYnkgaXMgcmVxdWlyZWQnIH0sXG4gICAgICAgICAgICAgICAgeyBzdGF0dXM6IDQwMCB9XG4gICAgICAgICAgICApO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3Qge1xuICAgICAgICAgICAgY2xhaW1faWQsXG4gICAgICAgICAgICBjbGFpbV90eXBlLFxuICAgICAgICAgICAgY29uZmlkZW5jZSxcbiAgICAgICAgICAgIGZsYWdzID0gW11cbiAgICAgICAgfSA9IGZlYXR1cmUucHJvcGVydGllcztcblxuICAgICAgICBpZiAoIWNsYWltX2lkIHx8ICFjbGFpbV90eXBlIHx8IGNvbmZpZGVuY2UgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICAgICAgICAgIHsgZXJyb3I6ICdNaXNzaW5nIHJlcXVpcmVkIHByb3BlcnRpZXM6IGNsYWltX2lkLCBjbGFpbV90eXBlLCBjb25maWRlbmNlJyB9LFxuICAgICAgICAgICAgICAgIHsgc3RhdHVzOiA0MDAgfVxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFByZXBhcmUgZGF0YSBmb3Igc3RvcmFnZVxuICAgICAgICAvLyBTdHJpY3QgR2VvbWV0cnkgVmFsaWRhdGlvblxuICAgICAgICBpZiAoIWZlYXR1cmUuZ2VvbWV0cnkgfHwgIWZlYXR1cmUuZ2VvbWV0cnkudHlwZSB8fCAhZmVhdHVyZS5nZW9tZXRyeS5jb29yZGluYXRlcykge1xuICAgICAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICAgICAgICAgIHsgZXJyb3I6ICdtaXNzaW5nX2dlb21ldHJ5JywgbWVzc2FnZTogJ0ZlYXR1cmUgZ2VvbWV0cnkgbWlzc2luZyBvciBpbnZhbGlkJyB9LFxuICAgICAgICAgICAgICAgIHsgc3RhdHVzOiA0MDAgfVxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFZhbGlkYXRlIGNvb3JkaW5hdGVzIHJhbmdlIChiYXNpYyBjaGVjaylcbiAgICAgICAgLy8gVE9ETzogVXNlIFR1cmYuanMgZm9yIG1vcmUgY29tcGxleCB2YWxpZGF0aW9uIGlmIG5lZWRlZFxuICAgICAgICBjb25zdCBpc1BvaW50ID0gZmVhdHVyZS5nZW9tZXRyeS50eXBlID09PSAnUG9pbnQnO1xuICAgICAgICBjb25zdCBpc1BvbHlnb24gPSBmZWF0dXJlLmdlb21ldHJ5LnR5cGUgPT09ICdQb2x5Z29uJyB8fCBmZWF0dXJlLmdlb21ldHJ5LnR5cGUgPT09ICdNdWx0aVBvbHlnb24nO1xuXG4gICAgICAgIGlmICghaXNQb2ludCAmJiAhaXNQb2x5Z29uKSB7XG4gICAgICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgICAgICAgICAgeyBlcnJvcjogJ2ludmFsaWRfZ2VvbWV0cnlfdHlwZScsIG1lc3NhZ2U6ICdPbmx5IFBvaW50LCBQb2x5Z29uLCBhbmQgTXVsdGlQb2x5Z29uIGFyZSBzdXBwb3J0ZWQnIH0sXG4gICAgICAgICAgICAgICAgeyBzdGF0dXM6IDQwMCB9XG4gICAgICAgICAgICApO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgZ2VvanNvblN0ciA9IEpTT04uc3RyaW5naWZ5KGZlYXR1cmUpO1xuICAgICAgICBjb25zdCBmbGFnc1N0ciA9IEpTT04uc3RyaW5naWZ5KGZsYWdzKTtcblxuICAgICAgICAvLyBVc2UgU1FMaXRlIGRhdGFiYXNlIG9wZXJhdGlvbnNcbiAgICAgICAgY29uc3QgZGIgPSBhd2FpdCBnZXREYigpO1xuXG4gICAgICAgIC8vIENoZWNrIGlmIGNsYWltIGFscmVhZHkgZXhpc3RzXG4gICAgICAgIGNvbnN0IGV4aXN0aW5nQ2xhaW0gPSBhd2FpdCBkYi5nZXQoXG4gICAgICAgICAgICAnU0VMRUNUIGlkLCB2ZXJzaW9uIEZST00gY2xhaW1zIFdIRVJFIGNsYWltX2lkID0gPycsXG4gICAgICAgICAgICBbY2xhaW1faWRdXG4gICAgICAgICk7XG5cbiAgICAgICAgbGV0IGNsYWltRGJJZCA9IGV4aXN0aW5nQ2xhaW0gPyBleGlzdGluZ0NsYWltLmlkIDogcmFuZG9tVVVJRCgpO1xuICAgICAgICBsZXQgbmV3VmVyc2lvbiA9IGV4aXN0aW5nQ2xhaW0gPyBleGlzdGluZ0NsYWltLnZlcnNpb24gKyAxIDogMTtcbiAgICAgICAgbGV0IHNhdmVkQXQ7XG5cbiAgICAgICAgaWYgKGV4aXN0aW5nQ2xhaW0pIHtcbiAgICAgICAgICAgIC8vIFVwZGF0ZSBleGlzdGluZyBjbGFpbVxuICAgICAgICAgICAgYXdhaXQgZGIucnVuKFxuICAgICAgICAgICAgICAgIGBVUERBVEUgY2xhaW1zIFxuICAgICAgICAgICAgICAgIFNFVCBnZW9qc29uID0gPywgY3VycmVudF9mbGFncyA9ID8sIGN1cnJlbnRfY29uZmlkZW5jZSA9ID8sIHNhdmVkX2J5ID0gPywgdmVyc2lvbiA9ID8sIHNhdmVkX2F0ID0gZGF0ZXRpbWUoJ25vdycpLCBjbGFpbV90eXBlID0gP1xuICAgICAgICAgICAgICAgIFdIRVJFIGlkID0gP2AsXG4gICAgICAgICAgICAgICAgW2dlb2pzb25TdHIsIGZsYWdzU3RyLCBjb25maWRlbmNlLCBzYXZlZF9ieSwgbmV3VmVyc2lvbiwgY2xhaW1fdHlwZSwgY2xhaW1EYklkXVxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgLy8gRmV0Y2ggdXBkYXRlZCB0aW1lc3RhbXBcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZWQgPSBhd2FpdCBkYi5nZXQoJ1NFTEVDVCBzYXZlZF9hdCBGUk9NIGNsYWltcyBXSEVSRSBpZCA9ID8nLCBbY2xhaW1EYklkXSk7XG4gICAgICAgICAgICBzYXZlZEF0ID0gdXBkYXRlZC5zYXZlZF9hdDtcblxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gSW5zZXJ0IG5ldyBjbGFpbVxuICAgICAgICAgICAgYXdhaXQgZGIucnVuKFxuICAgICAgICAgICAgICAgIGBJTlNFUlQgSU5UTyBjbGFpbXMgXG4gICAgICAgICAgICAgICAgKGlkLCBjbGFpbV9pZCwgY2xhaW1fdHlwZSwgZ2VvanNvbiwgY3VycmVudF9mbGFncywgY3VycmVudF9jb25maWRlbmNlLCBzYXZlZF9ieSwgdmVyc2lvbiwgc2F2ZWRfYXQpXG4gICAgICAgICAgICAgICAgVkFMVUVTICg/LCA/LCA/LCA/LCA/LCA/LCA/LCA/LCBkYXRldGltZSgnbm93JykpYCxcbiAgICAgICAgICAgICAgICBbY2xhaW1EYklkLCBjbGFpbV9pZCwgY2xhaW1fdHlwZSwgZ2VvanNvblN0ciwgZmxhZ3NTdHIsIGNvbmZpZGVuY2UsIHNhdmVkX2J5LCBuZXdWZXJzaW9uXVxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgLy8gRmV0Y2ggdGltZXN0YW1wXG4gICAgICAgICAgICBjb25zdCBpbnNlcnRlZCA9IGF3YWl0IGRiLmdldCgnU0VMRUNUIHNhdmVkX2F0IEZST00gY2xhaW1zIFdIRVJFIGlkID0gPycsIFtjbGFpbURiSWRdKTtcbiAgICAgICAgICAgIHNhdmVkQXQgPSBpbnNlcnRlZC5zYXZlZF9hdDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEFyY2hpdmUgdmVyc2lvblxuICAgICAgICBjb25zdCB2ZXJzaW9uSWQgPSByYW5kb21VVUlEKCk7XG4gICAgICAgIGF3YWl0IGRiLnJ1bihcbiAgICAgICAgICAgIGBJTlNFUlQgSU5UTyBjbGFpbV92ZXJzaW9ucyBcbiAgICAgICAgICAgIChpZCwgY2xhaW1fZGJfaWQsIHZlcnNpb24sIGdlb2pzb24sIGZsYWdzLCBjb25maWRlbmNlLCBzYXZlZF9ieSwgc2F2ZWRfYXQpXG4gICAgICAgICAgICBWQUxVRVMgKD8sID8sID8sID8sID8sID8sID8sIGRhdGV0aW1lKCdub3cnKSlgLFxuICAgICAgICAgICAgW3ZlcnNpb25JZCwgY2xhaW1EYklkLCBuZXdWZXJzaW9uLCBnZW9qc29uU3RyLCBmbGFnc1N0ciwgY29uZmlkZW5jZSwgc2F2ZWRfYnldXG4gICAgICAgICk7XG5cbiAgICAgICAgY29uc3QgcmVzdWx0ID0ge1xuICAgICAgICAgICAgaWQ6IGNsYWltRGJJZCxcbiAgICAgICAgICAgIGNsYWltX2lkLFxuICAgICAgICAgICAgdmVyc2lvbjogbmV3VmVyc2lvbixcbiAgICAgICAgICAgIHNhdmVkX2F0OiBzYXZlZEF0LFxuICAgICAgICAgICAgaGFzX2dlb21ldHJ5OiB0cnVlXG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAuLi5yZXN1bHRcbiAgICAgICAgfSk7XG5cbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHNhdmluZyBjbGFpbTonLCBlcnJvcik7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBlcnJvcjogJ0ZhaWxlZCB0byBzYXZlIGNsYWltJyxcbiAgICAgICAgICAgICAgICBkZXRhaWxzOiBTdHJpbmcoZXJyb3IpLFxuICAgICAgICAgICAgICAgIHN0YWNrOiBlcnJvci5zdGFja1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHsgc3RhdHVzOiA1MDAgfVxuICAgICAgICApO1xuICAgIH1cbn1cbiJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJnZXREYiIsInJhbmRvbVVVSUQiLCJQT1NUIiwicmVxdWVzdCIsImJvZHkiLCJqc29uIiwiZmVhdHVyZSIsInNhdmVkX2J5IiwicHJvcGVydGllcyIsImdlb21ldHJ5IiwiZXJyb3IiLCJzdGF0dXMiLCJjbGFpbV9pZCIsImNsYWltX3R5cGUiLCJjb25maWRlbmNlIiwiZmxhZ3MiLCJ1bmRlZmluZWQiLCJ0eXBlIiwiY29vcmRpbmF0ZXMiLCJtZXNzYWdlIiwiaXNQb2ludCIsImlzUG9seWdvbiIsImdlb2pzb25TdHIiLCJKU09OIiwic3RyaW5naWZ5IiwiZmxhZ3NTdHIiLCJkYiIsImV4aXN0aW5nQ2xhaW0iLCJnZXQiLCJjbGFpbURiSWQiLCJpZCIsIm5ld1ZlcnNpb24iLCJ2ZXJzaW9uIiwic2F2ZWRBdCIsInJ1biIsInVwZGF0ZWQiLCJzYXZlZF9hdCIsImluc2VydGVkIiwidmVyc2lvbklkIiwicmVzdWx0IiwiaGFzX2dlb21ldHJ5Iiwic3VjY2VzcyIsImNvbnNvbGUiLCJkZXRhaWxzIiwiU3RyaW5nIiwic3RhY2siXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./app/api/claims/save/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/dbSqlite.ts":
/*!*************************!*\
  !*** ./lib/dbSqlite.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   closeDb: () => (/* binding */ closeDb),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   ensureAdminPassword: () => (/* binding */ ensureAdminPassword),\n/* harmony export */   getDb: () => (/* binding */ getDb),\n/* harmony export */   query: () => (/* binding */ query)\n/* harmony export */ });\n/* harmony import */ var sqlite3__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! sqlite3 */ \"sqlite3\");\n/* harmony import */ var sqlite3__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(sqlite3__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var sqlite__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! sqlite */ \"(rsc)/./node_modules/sqlite/build/index.mjs\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! bcryptjs */ \"(rsc)/./node_modules/bcryptjs/index.js\");\n// Imported from Multilingual Copy - Data Digitalization Module - Safe Integration\n\n\n\n\n// Database configuration\nconst dbPath = path__WEBPACK_IMPORTED_MODULE_2___default().join(process.cwd(), \"fra_atlas.db\");\nlet dbInstance = null;\n/**\n * Get database connection\n */ async function getDb() {\n    if (dbInstance) {\n        return dbInstance;\n    }\n    dbInstance = await (0,sqlite__WEBPACK_IMPORTED_MODULE_1__.open)({\n        filename: dbPath,\n        driver: (sqlite3__WEBPACK_IMPORTED_MODULE_0___default().Database)\n    });\n    // Enable foreign keys and WAL mode for better concurrency\n    await dbInstance.run(\"PRAGMA foreign_keys = ON\");\n    await dbInstance.run(\"PRAGMA journal_mode = WAL\");\n    await dbInstance.run(\"PRAGMA busy_timeout = 5000\");\n    // Ensure admin table exists\n    await dbInstance.run(`\n        CREATE TABLE IF NOT EXISTS admin (\n            id INTEGER PRIMARY KEY AUTOINCREMENT,\n            hashed_password TEXT NOT NULL,\n            created_at TEXT,\n            updated_at TEXT\n        )\n    `);\n    // Ensure claims table exists\n    await dbInstance.run(`\n        CREATE TABLE IF NOT EXISTS claims (\n            id TEXT PRIMARY KEY,\n            claim_id TEXT UNIQUE NOT NULL,\n            claim_type TEXT NOT NULL,\n            geojson TEXT NOT NULL,\n            current_flags TEXT,\n            current_confidence REAL,\n            saved_by TEXT,\n            version INTEGER DEFAULT 1,\n            saved_at TEXT\n        )\n    `);\n    // Ensure claim_versions table exists\n    await dbInstance.run(`\n        CREATE TABLE IF NOT EXISTS claim_versions (\n            id TEXT PRIMARY KEY,\n            claim_db_id TEXT NOT NULL,\n            version INTEGER NOT NULL,\n            geojson TEXT NOT NULL,\n            flags TEXT,\n            confidence REAL,\n            saved_by TEXT,\n            saved_at TEXT,\n            FOREIGN KEY (claim_db_id) REFERENCES claims(id)\n        )\n    `);\n    // Ensure audit_log table exists\n    await dbInstance.run(`\n        CREATE TABLE IF NOT EXISTS audit_log (\n            id TEXT PRIMARY KEY,\n            action TEXT NOT NULL,\n            user_identifier TEXT,\n            ip_address TEXT,\n            success INTEGER,\n            details TEXT,\n            created_at TEXT\n        )\n    `);\n    // Ensure an admin record exists with a default password if none set\n    await ensureAdminPassword();\n    return dbInstance;\n}\n/**\n * Execute a query with parameters (SQLite version)\n */ async function query(text, params) {\n    const db = await getDb();\n    try {\n        const rows = await db.all(text, params || []);\n        return {\n            rows\n        };\n    } catch (error) {\n        console.error(\"SQLite query error:\", error);\n        throw error;\n    }\n}\n/**\n * Close database connection\n */ async function closeDb() {\n    if (dbInstance) {\n        await dbInstance.close();\n        dbInstance = null;\n    }\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({\n    getDb,\n    query,\n    closeDb,\n    ensureAdminPassword\n});\n/**\n * Ensure there is at least one admin entry with a default password.\n * This runs on server start. If an admin already exists, it does nothing.\n */ async function ensureAdminPassword() {\n    const db = await getDb();\n    const result = await db.get(\"SELECT COUNT(*) as count FROM admin\");\n    if (result?.count === 0) {\n        const defaultPassword = \"admin123\"; // you can change this later\n        const hashed = await bcryptjs__WEBPACK_IMPORTED_MODULE_3__[\"default\"].hash(defaultPassword, 12);\n        await db.run('INSERT INTO admin (hashed_password, created_at, updated_at) VALUES (?, datetime(\"now\"), datetime(\"now\"))', [\n            hashed\n        ]);\n        console.log('âœ… Default admin password set to \"admin123\"');\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvZGJTcWxpdGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7QUFBQSxrRkFBa0Y7QUFDcEQ7QUFDVTtBQUNoQjtBQUNNO0FBRTlCLHlCQUF5QjtBQUN6QixNQUFNSSxTQUFTRixnREFBUyxDQUFDSSxRQUFRQyxHQUFHLElBQUk7QUFFeEMsSUFBSUMsYUFBOEI7QUFFbEM7O0NBRUMsR0FDTSxlQUFlQztJQUNsQixJQUFJRCxZQUFZO1FBQ1osT0FBT0E7SUFDWDtJQUVBQSxhQUFhLE1BQU1QLDRDQUFJQSxDQUFDO1FBQ3BCUyxVQUFVTjtRQUNWTyxRQUFRWCx5REFBZ0I7SUFDNUI7SUFFQSwwREFBMEQ7SUFDMUQsTUFBTVEsV0FBV0ssR0FBRyxDQUFDO0lBQ3JCLE1BQU1MLFdBQVdLLEdBQUcsQ0FBQztJQUNyQixNQUFNTCxXQUFXSyxHQUFHLENBQUM7SUFFckIsNEJBQTRCO0lBQzVCLE1BQU1MLFdBQVdLLEdBQUcsQ0FBQyxDQUFDOzs7Ozs7O0lBT3RCLENBQUM7SUFFRCw2QkFBNkI7SUFDN0IsTUFBTUwsV0FBV0ssR0FBRyxDQUFDLENBQUM7Ozs7Ozs7Ozs7OztJQVl0QixDQUFDO0lBRUQscUNBQXFDO0lBQ3JDLE1BQU1MLFdBQVdLLEdBQUcsQ0FBQyxDQUFDOzs7Ozs7Ozs7Ozs7SUFZdEIsQ0FBQztJQUVELGdDQUFnQztJQUNoQyxNQUFNTCxXQUFXSyxHQUFHLENBQUMsQ0FBQzs7Ozs7Ozs7OztJQVV0QixDQUFDO0lBRUQsb0VBQW9FO0lBQ3BFLE1BQU1DO0lBQ04sT0FBT047QUFDWDtBQUVBOztDQUVDLEdBQ00sZUFBZU8sTUFDbEJDLElBQVksRUFDWkMsTUFBYztJQUVkLE1BQU1DLEtBQUssTUFBTVQ7SUFFakIsSUFBSTtRQUNBLE1BQU1VLE9BQU8sTUFBTUQsR0FBR0UsR0FBRyxDQUFDSixNQUFNQyxVQUFVLEVBQUU7UUFDNUMsT0FBTztZQUFFRTtRQUFLO0lBQ2xCLEVBQUUsT0FBT0UsT0FBTztRQUNaQyxRQUFRRCxLQUFLLENBQUMsdUJBQXVCQTtRQUNyQyxNQUFNQTtJQUNWO0FBQ0o7QUFFQTs7Q0FFQyxHQUNNLGVBQWVFO0lBQ2xCLElBQUlmLFlBQVk7UUFDWixNQUFNQSxXQUFXZ0IsS0FBSztRQUN0QmhCLGFBQWE7SUFDakI7QUFDSjtBQUVBLGlFQUFlO0lBQ1hDO0lBQ0FNO0lBQ0FRO0lBQ0FUO0FBQ0osQ0FBQyxFQUFDO0FBRUY7OztDQUdDLEdBQ00sZUFBZUE7SUFDbEIsTUFBTUksS0FBSyxNQUFNVDtJQUNqQixNQUFNZ0IsU0FBUyxNQUFNUCxHQUFHUSxHQUFHLENBQUM7SUFDNUIsSUFBSUQsUUFBUUUsVUFBVSxHQUFHO1FBQ3JCLE1BQU1DLGtCQUFrQixZQUFZLDRCQUE0QjtRQUNoRSxNQUFNQyxTQUFTLE1BQU0xQixxREFBVyxDQUFDeUIsaUJBQWlCO1FBQ2xELE1BQU1WLEdBQUdMLEdBQUcsQ0FBQyw0R0FBNEc7WUFBQ2dCO1NBQU87UUFDaklQLFFBQVFTLEdBQUcsQ0FBQztJQUNoQjtBQUNKIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZnJhLWF0bGFzLy4vbGliL2RiU3FsaXRlLnRzP2FlYzIiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gSW1wb3J0ZWQgZnJvbSBNdWx0aWxpbmd1YWwgQ29weSAtIERhdGEgRGlnaXRhbGl6YXRpb24gTW9kdWxlIC0gU2FmZSBJbnRlZ3JhdGlvblxuaW1wb3J0IHNxbGl0ZTMgZnJvbSAnc3FsaXRlMyc7XG5pbXBvcnQgeyBvcGVuLCBEYXRhYmFzZSB9IGZyb20gJ3NxbGl0ZSc7XG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJztcbmltcG9ydCBiY3J5cHQgZnJvbSAnYmNyeXB0anMnO1xuXG4vLyBEYXRhYmFzZSBjb25maWd1cmF0aW9uXG5jb25zdCBkYlBhdGggPSBwYXRoLmpvaW4ocHJvY2Vzcy5jd2QoKSwgJ2ZyYV9hdGxhcy5kYicpO1xuXG5sZXQgZGJJbnN0YW5jZTogRGF0YWJhc2UgfCBudWxsID0gbnVsbDtcblxuLyoqXG4gKiBHZXQgZGF0YWJhc2UgY29ubmVjdGlvblxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0RGIoKTogUHJvbWlzZTxEYXRhYmFzZT4ge1xuICAgIGlmIChkYkluc3RhbmNlKSB7XG4gICAgICAgIHJldHVybiBkYkluc3RhbmNlO1xuICAgIH1cblxuICAgIGRiSW5zdGFuY2UgPSBhd2FpdCBvcGVuKHtcbiAgICAgICAgZmlsZW5hbWU6IGRiUGF0aCxcbiAgICAgICAgZHJpdmVyOiBzcWxpdGUzLkRhdGFiYXNlXG4gICAgfSk7XG5cbiAgICAvLyBFbmFibGUgZm9yZWlnbiBrZXlzIGFuZCBXQUwgbW9kZSBmb3IgYmV0dGVyIGNvbmN1cnJlbmN5XG4gICAgYXdhaXQgZGJJbnN0YW5jZS5ydW4oJ1BSQUdNQSBmb3JlaWduX2tleXMgPSBPTicpO1xuICAgIGF3YWl0IGRiSW5zdGFuY2UucnVuKCdQUkFHTUEgam91cm5hbF9tb2RlID0gV0FMJyk7XG4gICAgYXdhaXQgZGJJbnN0YW5jZS5ydW4oJ1BSQUdNQSBidXN5X3RpbWVvdXQgPSA1MDAwJyk7XG5cbiAgICAvLyBFbnN1cmUgYWRtaW4gdGFibGUgZXhpc3RzXG4gICAgYXdhaXQgZGJJbnN0YW5jZS5ydW4oYFxuICAgICAgICBDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyBhZG1pbiAoXG4gICAgICAgICAgICBpZCBJTlRFR0VSIFBSSU1BUlkgS0VZIEFVVE9JTkNSRU1FTlQsXG4gICAgICAgICAgICBoYXNoZWRfcGFzc3dvcmQgVEVYVCBOT1QgTlVMTCxcbiAgICAgICAgICAgIGNyZWF0ZWRfYXQgVEVYVCxcbiAgICAgICAgICAgIHVwZGF0ZWRfYXQgVEVYVFxuICAgICAgICApXG4gICAgYCk7XG5cbiAgICAvLyBFbnN1cmUgY2xhaW1zIHRhYmxlIGV4aXN0c1xuICAgIGF3YWl0IGRiSW5zdGFuY2UucnVuKGBcbiAgICAgICAgQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgY2xhaW1zIChcbiAgICAgICAgICAgIGlkIFRFWFQgUFJJTUFSWSBLRVksXG4gICAgICAgICAgICBjbGFpbV9pZCBURVhUIFVOSVFVRSBOT1QgTlVMTCxcbiAgICAgICAgICAgIGNsYWltX3R5cGUgVEVYVCBOT1QgTlVMTCxcbiAgICAgICAgICAgIGdlb2pzb24gVEVYVCBOT1QgTlVMTCxcbiAgICAgICAgICAgIGN1cnJlbnRfZmxhZ3MgVEVYVCxcbiAgICAgICAgICAgIGN1cnJlbnRfY29uZmlkZW5jZSBSRUFMLFxuICAgICAgICAgICAgc2F2ZWRfYnkgVEVYVCxcbiAgICAgICAgICAgIHZlcnNpb24gSU5URUdFUiBERUZBVUxUIDEsXG4gICAgICAgICAgICBzYXZlZF9hdCBURVhUXG4gICAgICAgIClcbiAgICBgKTtcblxuICAgIC8vIEVuc3VyZSBjbGFpbV92ZXJzaW9ucyB0YWJsZSBleGlzdHNcbiAgICBhd2FpdCBkYkluc3RhbmNlLnJ1bihgXG4gICAgICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIGNsYWltX3ZlcnNpb25zIChcbiAgICAgICAgICAgIGlkIFRFWFQgUFJJTUFSWSBLRVksXG4gICAgICAgICAgICBjbGFpbV9kYl9pZCBURVhUIE5PVCBOVUxMLFxuICAgICAgICAgICAgdmVyc2lvbiBJTlRFR0VSIE5PVCBOVUxMLFxuICAgICAgICAgICAgZ2VvanNvbiBURVhUIE5PVCBOVUxMLFxuICAgICAgICAgICAgZmxhZ3MgVEVYVCxcbiAgICAgICAgICAgIGNvbmZpZGVuY2UgUkVBTCxcbiAgICAgICAgICAgIHNhdmVkX2J5IFRFWFQsXG4gICAgICAgICAgICBzYXZlZF9hdCBURVhULFxuICAgICAgICAgICAgRk9SRUlHTiBLRVkgKGNsYWltX2RiX2lkKSBSRUZFUkVOQ0VTIGNsYWltcyhpZClcbiAgICAgICAgKVxuICAgIGApO1xuXG4gICAgLy8gRW5zdXJlIGF1ZGl0X2xvZyB0YWJsZSBleGlzdHNcbiAgICBhd2FpdCBkYkluc3RhbmNlLnJ1bihgXG4gICAgICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIGF1ZGl0X2xvZyAoXG4gICAgICAgICAgICBpZCBURVhUIFBSSU1BUlkgS0VZLFxuICAgICAgICAgICAgYWN0aW9uIFRFWFQgTk9UIE5VTEwsXG4gICAgICAgICAgICB1c2VyX2lkZW50aWZpZXIgVEVYVCxcbiAgICAgICAgICAgIGlwX2FkZHJlc3MgVEVYVCxcbiAgICAgICAgICAgIHN1Y2Nlc3MgSU5URUdFUixcbiAgICAgICAgICAgIGRldGFpbHMgVEVYVCxcbiAgICAgICAgICAgIGNyZWF0ZWRfYXQgVEVYVFxuICAgICAgICApXG4gICAgYCk7XG5cbiAgICAvLyBFbnN1cmUgYW4gYWRtaW4gcmVjb3JkIGV4aXN0cyB3aXRoIGEgZGVmYXVsdCBwYXNzd29yZCBpZiBub25lIHNldFxuICAgIGF3YWl0IGVuc3VyZUFkbWluUGFzc3dvcmQoKTtcbiAgICByZXR1cm4gZGJJbnN0YW5jZTtcbn1cblxuLyoqXG4gKiBFeGVjdXRlIGEgcXVlcnkgd2l0aCBwYXJhbWV0ZXJzIChTUUxpdGUgdmVyc2lvbilcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHF1ZXJ5PFQgPSBhbnk+KFxuICAgIHRleHQ6IHN0cmluZyxcbiAgICBwYXJhbXM/OiBhbnlbXVxuKTogUHJvbWlzZTx7IHJvd3M6IFRbXSB9PiB7XG4gICAgY29uc3QgZGIgPSBhd2FpdCBnZXREYigpO1xuXG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3Qgcm93cyA9IGF3YWl0IGRiLmFsbCh0ZXh0LCBwYXJhbXMgfHwgW10pO1xuICAgICAgICByZXR1cm4geyByb3dzIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignU1FMaXRlIHF1ZXJ5IGVycm9yOicsIGVycm9yKTtcbiAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxufVxuXG4vKipcbiAqIENsb3NlIGRhdGFiYXNlIGNvbm5lY3Rpb25cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNsb3NlRGIoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgaWYgKGRiSW5zdGFuY2UpIHtcbiAgICAgICAgYXdhaXQgZGJJbnN0YW5jZS5jbG9zZSgpO1xuICAgICAgICBkYkluc3RhbmNlID0gbnVsbDtcbiAgICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IHtcbiAgICBnZXREYixcbiAgICBxdWVyeSxcbiAgICBjbG9zZURiLFxuICAgIGVuc3VyZUFkbWluUGFzc3dvcmQsXG59O1xuXG4vKipcbiAqIEVuc3VyZSB0aGVyZSBpcyBhdCBsZWFzdCBvbmUgYWRtaW4gZW50cnkgd2l0aCBhIGRlZmF1bHQgcGFzc3dvcmQuXG4gKiBUaGlzIHJ1bnMgb24gc2VydmVyIHN0YXJ0LiBJZiBhbiBhZG1pbiBhbHJlYWR5IGV4aXN0cywgaXQgZG9lcyBub3RoaW5nLlxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZW5zdXJlQWRtaW5QYXNzd29yZCgpIHtcbiAgICBjb25zdCBkYiA9IGF3YWl0IGdldERiKCk7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuZ2V0KCdTRUxFQ1QgQ09VTlQoKikgYXMgY291bnQgRlJPTSBhZG1pbicpO1xuICAgIGlmIChyZXN1bHQ/LmNvdW50ID09PSAwKSB7XG4gICAgICAgIGNvbnN0IGRlZmF1bHRQYXNzd29yZCA9ICdhZG1pbjEyMyc7IC8vIHlvdSBjYW4gY2hhbmdlIHRoaXMgbGF0ZXJcbiAgICAgICAgY29uc3QgaGFzaGVkID0gYXdhaXQgYmNyeXB0Lmhhc2goZGVmYXVsdFBhc3N3b3JkLCAxMik7XG4gICAgICAgIGF3YWl0IGRiLnJ1bignSU5TRVJUIElOVE8gYWRtaW4gKGhhc2hlZF9wYXNzd29yZCwgY3JlYXRlZF9hdCwgdXBkYXRlZF9hdCkgVkFMVUVTICg/LCBkYXRldGltZShcIm5vd1wiKSwgZGF0ZXRpbWUoXCJub3dcIikpJywgW2hhc2hlZF0pO1xuICAgICAgICBjb25zb2xlLmxvZygn4pyFIERlZmF1bHQgYWRtaW4gcGFzc3dvcmQgc2V0IHRvIFwiYWRtaW4xMjNcIicpO1xuICAgIH1cbn1cbiJdLCJuYW1lcyI6WyJzcWxpdGUzIiwib3BlbiIsInBhdGgiLCJiY3J5cHQiLCJkYlBhdGgiLCJqb2luIiwicHJvY2VzcyIsImN3ZCIsImRiSW5zdGFuY2UiLCJnZXREYiIsImZpbGVuYW1lIiwiZHJpdmVyIiwiRGF0YWJhc2UiLCJydW4iLCJlbnN1cmVBZG1pblBhc3N3b3JkIiwicXVlcnkiLCJ0ZXh0IiwicGFyYW1zIiwiZGIiLCJyb3dzIiwiYWxsIiwiZXJyb3IiLCJjb25zb2xlIiwiY2xvc2VEYiIsImNsb3NlIiwicmVzdWx0IiwiZ2V0IiwiY291bnQiLCJkZWZhdWx0UGFzc3dvcmQiLCJoYXNoZWQiLCJoYXNoIiwibG9nIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/dbSqlite.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/bcryptjs","vendor-chunks/sqlite"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fclaims%2Fsave%2Froute&page=%2Fapi%2Fclaims%2Fsave%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fclaims%2Fsave%2Froute.ts&appDir=%2FUsers%2Fvinaykumar%2FDesktop%2Fdss-atlas-digitalisation%2Fdss-atlas%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fvinaykumar%2FDesktop%2Fdss-atlas-digitalisation%2Fdss-atlas&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();